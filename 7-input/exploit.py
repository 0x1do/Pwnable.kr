from pwn import *
import os

#stage1
args = ['\x01']*100
args[65] = '\x00'
args[66] = '\x20\x0a\x0d'

#stage2
read_fd1, write_fd1 = os.pipe()
read_fd2, write_fd2 = os.pipe()

os.write(write_fd1, '\x00\x0a\x00\xff')
os.write(write_fd2, '\x00\x0a\x02\xff')

#stage4
file = open('\x0a', 'w')
file.write('\x00\x00\x00\x00')
file.close()

#stage5
args[67] = '4444'

p = process(executable='/home/input2/input', argv=args, stdin=read_fd1,
stderr=read_fd2, env={'\xde\xad\xbe\xef' :'\xca\xfe\xba\xbe'})

#stage5 - part2
r = remote('localhost', int(args[67]))
r.sendline('\xde\xad\xbe\xef')

p.interactive()
